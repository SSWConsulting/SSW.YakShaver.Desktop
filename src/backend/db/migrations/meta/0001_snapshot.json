{
  "version": "6",
  "dialect": "sqlite",
  "id": "c46adb6d-16ed-4e6e-8f5d-665a049671a9",
  "prevId": "60987411-208d-4159-88f2-f08f98e04d96",
  "tables": {
    "ai_completions": {
      "name": "ai_completions",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "shave_attempt_id": {
          "name": "shave_attempt_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "provider": {
          "name": "provider",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "model": {
          "name": "model",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "context_stage": {
          "name": "context_stage",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "input_json": {
          "name": "input_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "output_json": {
          "name": "output_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "input_tokens": {
          "name": "input_tokens",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "output_tokens": {
          "name": "output_tokens",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "duration_ms": {
          "name": "duration_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_ai_completions_attempt": {
          "name": "idx_ai_completions_attempt",
          "columns": [
            "shave_attempt_id"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "ai_completions_shave_attempt_id_shave_attempts_id_fk": {
          "name": "ai_completions_shave_attempt_id_shave_attempts_id_fk",
          "tableFrom": "ai_completions",
          "tableTo": "shave_attempts",
          "columnsFrom": [
            "shave_attempt_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "process_steps": {
      "name": "process_steps",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "shave_attempt_id": {
          "name": "shave_attempt_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "stage": {
          "name": "stage",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "payload_json": {
          "name": "payload_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_process_steps_attempt": {
          "name": "idx_process_steps_attempt",
          "columns": [
            "shave_attempt_id"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "process_steps_shave_attempt_id_shave_attempts_id_fk": {
          "name": "process_steps_shave_attempt_id_shave_attempts_id_fk",
          "tableFrom": "process_steps",
          "tableTo": "shave_attempts",
          "columnsFrom": [
            "shave_attempt_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "prompts": {
      "name": "prompts",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "user_id": {
          "name": "user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "instruction": {
          "name": "instruction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "is_active": {
          "name": "is_active",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": false
        },
        "activated_at": {
          "name": "activated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_prompts_active": {
          "name": "idx_prompts_active",
          "columns": [
            "is_active"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "prompts_user_id_users_id_fk": {
          "name": "prompts_user_id_users_id_fk",
          "tableFrom": "prompts",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "shave_attempts": {
      "name": "shave_attempts",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "shave_id": {
          "name": "shave_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "run_type": {
          "name": "run_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "parent_attempt_id": {
          "name": "parent_attempt_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "started_from_stage": {
          "name": "started_from_stage",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "prompt_snapshot": {
          "name": "prompt_snapshot",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "final_output_json": {
          "name": "final_output_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "portal_sync_status": {
          "name": "portal_sync_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "'pending'"
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        },
        "completed_at": {
          "name": "completed_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_shave_attempts_shave_id": {
          "name": "idx_shave_attempts_shave_id",
          "columns": [
            "shave_id"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "shave_attempts_shave_id_shaves_id_fk": {
          "name": "shave_attempts_shave_id_shaves_id_fk",
          "tableFrom": "shave_attempts",
          "tableTo": "shaves",
          "columnsFrom": [
            "shave_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "shaves": {
      "name": "shaves",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "video_source_id": {
          "name": "video_source_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "requester_user_id": {
          "name": "requester_user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "latest_attempt_id": {
          "name": "latest_attempt_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "client_origin": {
          "name": "client_origin",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "prompt_snapshot": {
          "name": "prompt_snapshot",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "final_output": {
          "name": "final_output",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "error_code": {
          "name": "error_code",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "total_duration_ms": {
          "name": "total_duration_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "project_name": {
          "name": "project_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "work_item_url": {
          "name": "work_item_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "shave_status": {
          "name": "shave_status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'Unknown'"
        },
        "video_embed_url": {
          "name": "video_embed_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_shaves_video_embed_url": {
          "name": "idx_shaves_video_embed_url",
          "columns": [
            "video_embed_url"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "tool_calls": {
      "name": "tool_calls",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "shave_attempt_id": {
          "name": "shave_attempt_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "tool_name": {
          "name": "tool_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "service_name": {
          "name": "service_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "user_input_required": {
          "name": "user_input_required",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": false
        },
        "args_json": {
          "name": "args_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "result_json": {
          "name": "result_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "success": {
          "name": "success",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "duration_ms": {
          "name": "duration_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_tool_calls_attempt": {
          "name": "idx_tool_calls_attempt",
          "columns": [
            "shave_attempt_id"
          ],
          "isUnique": false
        },
        "idx_tool_calls_tool": {
          "name": "idx_tool_calls_tool",
          "columns": [
            "tool_name"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "tool_calls_shave_attempt_id_shave_attempts_id_fk": {
          "name": "tool_calls_shave_attempt_id_shave_attempts_id_fk",
          "tableFrom": "tool_calls",
          "tableTo": "shave_attempts",
          "columnsFrom": [
            "shave_attempt_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "transcripts": {
      "name": "transcripts",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "shave_attempt_id": {
          "name": "shave_attempt_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "language_code": {
          "name": "language_code",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "content": {
          "name": "content",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_transcripts_attempt": {
          "name": "idx_transcripts_attempt",
          "columns": [
            "shave_attempt_id"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "transcripts_shave_attempt_id_shave_attempts_id_fk": {
          "name": "transcripts_shave_attempt_id_shave_attempts_id_fk",
          "tableFrom": "transcripts",
          "tableTo": "shave_attempts",
          "columnsFrom": [
            "shave_attempt_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "user_identities": {
      "name": "user_identities",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "user_id": {
          "name": "user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "provider": {
          "name": "provider",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "provider_user_id": {
          "name": "provider_user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "provider_metadata": {
          "name": "provider_metadata",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "display_name": {
          "name": "display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "avatar_url": {
          "name": "avatar_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "last_login_at": {
          "name": "last_login_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "user_identities_user_id_users_id_fk": {
          "name": "user_identities_user_id_users_id_fk",
          "tableFrom": "user_identities",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "users": {
      "name": "users",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "is_anonymous": {
          "name": "is_anonymous",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": true
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "video_files": {
      "name": "video_files",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "video_source_id": {
          "name": "video_source_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "file_name": {
          "name": "file_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "local_path": {
          "name": "local_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "is_deleted": {
          "name": "is_deleted",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": false
        },
        "deleted_at": {
          "name": "deleted_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {
        "idx_video_files_video_source": {
          "name": "idx_video_files_video_source",
          "columns": [
            "video_source_id"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "video_sources": {
      "name": "video_sources",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "owner_user_id": {
          "name": "owner_user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "external_provider": {
          "name": "external_provider",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "'youtube'"
        },
        "external_id": {
          "name": "external_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "source_url": {
          "name": "source_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "duration_seconds": {
          "name": "duration_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "metadata_json": {
          "name": "metadata_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "(strftime('%Y-%m-%dT%H:%M:%SZ', 'now'))"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "video_sources_owner_user_id_users_id_fk": {
          "name": "video_sources_owner_user_id_users_id_fk",
          "tableFrom": "video_sources",
          "tableTo": "users",
          "columnsFrom": [
            "owner_user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    }
  },
  "views": {},
  "enums": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {
      "\"shaves\".\"work_item_source\"": "\"shaves\".\"client_origin\"",
      "\"video_files\".\"file_path\"": "\"video_files\".\"local_path\""
    }
  },
  "internal": {
    "indexes": {}
  }
}